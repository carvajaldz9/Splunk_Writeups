Commonly Used Splunk Queries and searches for security threats

A. Authentication & Access Monitoring

1.
index=security (failed OR failure) (login OR authentication) 
| stats count by src_ip, user 
| sort -count

Purpose: Used to identify brute-force attempts by searching through desired index logs for failed login attempts

2.
index=windows EventCode=4625 
| stats count by src_ip, user 
| where count > 5

Purpose: Used to detect multiple failed windows logins by searchign for event cocde 4625

B. Malware & Ransomware Detection

1. 
index=endpoint (process="*.exe" OR file_created="*.encrypted") 
| stats count by host, process_name, file_path

Purpose: used for the detection of ransomware activity, searchign for key things such as executable processes followed by encryption 

2. 
index=proxy url=*malware* OR url=*exploit* 
| table src_ip, dest_ip, url, user_agent

Purpose: Detect malware download from proxy

C. Network Anomalies & Attacks

1. 
index=firewall action=denied 
| stats count by src_ip, dest_ip, dest_port 
| sort -count

Purpose: Identify blocked attack attempts.

2. 
index=netflow bytes > 1000000 
| stats sum(bytes) by src_ip, dest_ip 
| sort -sum(bytes)

Purpose: Find large data transfers (possible exfiltration).

D. Insider Threat Detection

1.
index=fileshare (file_deleted OR file_modified) 
| stats count by user, file_path 
| where count > 10

Purpose: Detect suspicious file modifications.


2. 
index=email (attachment="*.exe" OR attachment="*.js") 
| table sender, recipient, subject, attachment

Purpose: Find malicious email attachments.



